osboxes@master:~/LSDM-code$ spark-submit main.py B
Execution option: 'B'.
Question B - Running in RDD mode...
24/06/03 17:28:22 INFO SparkContext: Running Spark version 3.5.1
24/06/03 17:28:22 INFO SparkContext: OS info Linux, 5.15.0-101-generic, amd64
24/06/03 17:28:22 INFO SparkContext: Java version 1.8.0_402
24/06/03 17:28:22 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
24/06/03 17:28:22 INFO ResourceUtils: ==============================================================
24/06/03 17:28:22 INFO ResourceUtils: No custom resources configured for spark.driver.
24/06/03 17:28:22 INFO ResourceUtils: ==============================================================
24/06/03 17:28:22 INFO SparkContext: Submitted application: Question-A-DataFrame-Session
24/06/03 17:28:22 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 2, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
24/06/03 17:28:22 INFO ResourceProfile: Limiting resource is cpus at 2 tasks per executor
24/06/03 17:28:22 INFO ResourceProfileManager: Added ResourceProfile id: 0
24/06/03 17:28:22 INFO SecurityManager: Changing view acls to: osboxes
24/06/03 17:28:22 INFO SecurityManager: Changing modify acls to: osboxes
24/06/03 17:28:22 INFO SecurityManager: Changing view acls groups to:
24/06/03 17:28:22 INFO SecurityManager: Changing modify acls groups to:
24/06/03 17:28:22 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: osboxes; groups with view permissions: EMPTY; users with modify permissions: osboxes; groups with modify permissions: EMPTY
24/06/03 17:28:23 INFO Utils: Successfully started service 'sparkDriver' on port 33229.
24/06/03 17:28:23 INFO SparkEnv: Registering MapOutputTracker
24/06/03 17:28:23 INFO SparkEnv: Registering BlockManagerMaster
24/06/03 17:28:23 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
24/06/03 17:28:23 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
24/06/03 17:28:23 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
24/06/03 17:28:23 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-c73647dd-4f67-4e2c-bb5c-c9650d1df99a
24/06/03 17:28:23 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
24/06/03 17:28:23 INFO SparkEnv: Registering OutputCommitCoordinator
24/06/03 17:28:23 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
24/06/03 17:28:23 INFO Utils: Successfully started service 'SparkUI' on port 4040.
24/06/03 17:28:24 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://master:7077...
24/06/03 17:28:24 INFO TransportClientFactory: Successfully created connection to master/192.168.1.236:7077 after 63 ms (0 ms spent in bootstraps)
24/06/03 17:28:24 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20240603172824-0024
24/06/03 17:28:24 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20240603172824-0024/0 on worker-20240603125029-192.168.1.236-42015 (192.168.1.236:42015) with 2 core(s)
24/06/03 17:28:24 INFO StandaloneSchedulerBackend: Granted executor ID app-20240603172824-0024/0 on hostPort 192.168.1.236:42015 with 2 core(s), 1024.0 MiB RAM
24/06/03 17:28:24 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20240603172824-0024/1 on worker-20240603125027-192.168.1.20-37983 (192.168.1.20:37983) with 2 core(s)
24/06/03 17:28:24 INFO StandaloneSchedulerBackend: Granted executor ID app-20240603172824-0024/1 on hostPort 192.168.1.20:37983 with 2 core(s), 1024.0 MiB RAM
24/06/03 17:28:24 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 42497.
24/06/03 17:28:24 INFO NettyBlockTransferService: Server created on master:42497
24/06/03 17:28:24 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
24/06/03 17:28:24 INFO StandaloneAppClient$ClientEndpoint: Executor updated: app-20240603172824-0024/1 is now RUNNING
24/06/03 17:28:24 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, master, 42497, None)
24/06/03 17:28:24 INFO BlockManagerMasterEndpoint: Registering block manager master:42497 with 366.3 MiB RAM, BlockManagerId(driver, master, 42497, None)
24/06/03 17:28:24 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, master, 42497, None)
24/06/03 17:28:24 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, master, 42497, None)
24/06/03 17:28:24 INFO StandaloneAppClient$ClientEndpoint: Executor updated: app-20240603172824-0024/0 is now RUNNING
24/06/03 17:28:25 INFO SingleEventLogFileWriter: Logging events to file:/tmp/spark-events/app-20240603172824-0024.inprogress
24/06/03 17:28:26 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
Hostname: 'master', Private IP: '192.168.1.236'
24/06/03 17:28:27 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
24/06/03 17:28:27 INFO SharedState: Warehouse path is 'file:/home/osboxes/LSDM-code/spark-warehouse'.
24/06/03 17:28:29 INFO StandaloneSchedulerBackend$StandaloneDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.1.20:58878) with ID 1,  ResourceProfileId 0
24/06/03 17:28:30 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.1.20:35785 with 366.3 MiB RAM, BlockManagerId(1, 192.168.1.20, 35785, None)
24/06/03 17:28:32 INFO StandaloneSchedulerBackend$StandaloneDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.1.236:51902) with ID 0,  ResourceProfileId 0
24/06/03 17:28:32 INFO InMemoryFileIndex: It took 340 ms to list leaf files for 1 paths.
24/06/03 17:28:33 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.1.236:41671 with 366.3 MiB RAM, BlockManagerId(0, 192.168.1.236, 41671, None)
24/06/03 17:28:33 INFO InMemoryFileIndex: It took 59 ms to list leaf files for 9 paths.
24/06/03 17:28:37 INFO FileSourceStrategy: Pushed Filters:
24/06/03 17:28:37 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
24/06/03 17:28:39 INFO CodeGenerator: Code generated in 551.300176 ms
24/06/03 17:28:39 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 353.6 KiB, free 366.0 MiB)
24/06/03 17:28:39 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.9 KiB, free 365.9 MiB)
24/06/03 17:28:39 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on master:42497 (size: 34.9 KiB, free: 366.3 MiB)
24/06/03 17:28:39 INFO SparkContext: Created broadcast 0 from csv at NativeMethodAccessorImpl.java:0
24/06/03 17:28:39 INFO FileSourceScanExec: Planning scan with bin packing, max size: 134217728 bytes, open cost is considered as scanning 4194304 bytes.
24/06/03 17:28:39 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
24/06/03 17:28:39 INFO DAGScheduler: Got job 0 (csv at NativeMethodAccessorImpl.java:0) with 1 output partitions
24/06/03 17:28:39 INFO DAGScheduler: Final stage: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0)
24/06/03 17:28:39 INFO DAGScheduler: Parents of final stage: List()
24/06/03 17:28:39 INFO DAGScheduler: Missing parents: List()
24/06/03 17:28:39 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
24/06/03 17:28:39 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 13.5 KiB, free 365.9 MiB)
24/06/03 17:28:39 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 6.4 KiB, free 365.9 MiB)
24/06/03 17:28:39 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on master:42497 (size: 6.4 KiB, free: 366.3 MiB)
24/06/03 17:28:39 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1585
24/06/03 17:28:39 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
24/06/03 17:28:39 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
24/06/03 17:28:39 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (192.168.1.236, executor 0, partition 0, ANY, 8289 bytes)
24/06/03 17:28:40 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 192.168.1.236:41671 (size: 6.4 KiB, free: 366.3 MiB)
24/06/03 17:28:42 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 192.168.1.236:41671 (size: 34.9 KiB, free: 366.3 MiB)
24/06/03 17:28:44 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 4435 ms on 192.168.1.236 (executor 0) (1/1)
24/06/03 17:28:44 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool
24/06/03 17:28:44 INFO DAGScheduler: ResultStage 0 (csv at NativeMethodAccessorImpl.java:0) finished in 4.662 s
24/06/03 17:28:44 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
24/06/03 17:28:44 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
24/06/03 17:28:44 INFO DAGScheduler: Job 0 finished: csv at NativeMethodAccessorImpl.java:0, took 4.819605 s
24/06/03 17:28:44 INFO CodeGenerator: Code generated in 57.556765 ms
24/06/03 17:28:44 INFO FileSourceStrategy: Pushed Filters:
24/06/03 17:28:44 INFO FileSourceStrategy: Post-Scan Filters:
24/06/03 17:28:44 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 353.6 KiB, free 365.6 MiB)
24/06/03 17:28:44 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.9 KiB, free 365.5 MiB)
24/06/03 17:28:44 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on master:42497 (size: 34.9 KiB, free: 366.2 MiB)
24/06/03 17:28:44 INFO SparkContext: Created broadcast 2 from csv at NativeMethodAccessorImpl.java:0
24/06/03 17:28:44 INFO FileSourceScanExec: Planning scan with bin packing, max size: 134217728 bytes, open cost is considered as scanning 4194304 bytes.
24/06/03 17:28:44 INFO SparkContext: Starting job: csv at NativeMethodAccessorImpl.java:0
24/06/03 17:28:44 INFO DAGScheduler: Got job 1 (csv at NativeMethodAccessorImpl.java:0) with 6 output partitions
24/06/03 17:28:44 INFO DAGScheduler: Final stage: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0)
24/06/03 17:28:44 INFO DAGScheduler: Parents of final stage: List()
24/06/03 17:28:44 INFO DAGScheduler: Missing parents: List()
24/06/03 17:28:44 INFO DAGScheduler: Submitting ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0), which has no missing parents
24/06/03 17:28:44 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 28.2 KiB, free 365.5 MiB)
24/06/03 17:28:44 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 13.0 KiB, free 365.5 MiB)
24/06/03 17:28:44 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on master:42497 (size: 13.0 KiB, free: 366.2 MiB)
24/06/03 17:28:44 INFO SparkContext: Created broadcast 3 from broadcast at DAGScheduler.scala:1585
24/06/03 17:28:44 INFO DAGScheduler: Submitting 6 missing tasks from ResultStage 1 (MapPartitionsRDD[9] at csv at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5))
24/06/03 17:28:44 INFO TaskSchedulerImpl: Adding task set 1.0 with 6 tasks resource profile 0
24/06/03 17:28:44 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (192.168.1.20, executor 1, partition 0, ANY, 8289 bytes)
24/06/03 17:28:44 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (192.168.1.236, executor 0, partition 1, ANY, 8289 bytes)
24/06/03 17:28:44 INFO TaskSetManager: Starting task 2.0 in stage 1.0 (TID 3) (192.168.1.20, executor 1, partition 2, ANY, 8289 bytes)
24/06/03 17:28:44 INFO TaskSetManager: Starting task 3.0 in stage 1.0 (TID 4) (192.168.1.236, executor 0, partition 3, ANY, 8289 bytes)
24/06/03 17:28:45 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 192.168.1.236:41671 (size: 13.0 KiB, free: 366.2 MiB)
24/06/03 17:28:45 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 192.168.1.20:35785 (size: 13.0 KiB, free: 366.3 MiB)
24/06/03 17:28:48 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 192.168.1.236:41671 (size: 34.9 KiB, free: 366.2 MiB)
24/06/03 17:28:51 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 192.168.1.20:35785 (size: 34.9 KiB, free: 366.3 MiB)
24/06/03 17:28:54 INFO TaskSetManager: Starting task 4.0 in stage 1.0 (TID 5) (192.168.1.236, executor 0, partition 4, ANY, 8453 bytes)
24/06/03 17:28:54 INFO TaskSetManager: Finished task 3.0 in stage 1.0 (TID 4) in 9312 ms on 192.168.1.236 (executor 0) (1/6)
24/06/03 17:28:54 INFO TaskSetManager: Starting task 5.0 in stage 1.0 (TID 6) (192.168.1.236, executor 0, partition 5, ANY, 8617 bytes)
24/06/03 17:28:54 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 9478 ms on 192.168.1.236 (executor 0) (2/6)
24/06/03 17:29:00 INFO TaskSetManager: Finished task 5.0 in stage 1.0 (TID 6) in 6445 ms on 192.168.1.236 (executor 0) (3/6)
24/06/03 17:29:01 INFO TaskSetManager: Finished task 4.0 in stage 1.0 (TID 5) in 6780 ms on 192.168.1.236 (executor 0) (4/6)
24/06/03 17:29:01 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 16828 ms on 192.168.1.20 (executor 1) (5/6)
24/06/03 17:29:03 INFO TaskSetManager: Finished task 2.0 in stage 1.0 (TID 3) in 18106 ms on 192.168.1.20 (executor 1) (6/6)
24/06/03 17:29:03 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool
24/06/03 17:29:03 INFO DAGScheduler: ResultStage 1 (csv at NativeMethodAccessorImpl.java:0) finished in 18.196 s
24/06/03 17:29:03 INFO DAGScheduler: Job 1 is finished. Cancelling potential speculative or zombie tasks for this job
24/06/03 17:29:03 INFO TaskSchedulerImpl: Killing all running tasks in stage 1: Stage finished
24/06/03 17:29:03 INFO DAGScheduler: Job 1 finished: csv at NativeMethodAccessorImpl.java:0, took 18.221850 s
24/06/03 17:29:03 INFO FileSourceStrategy: Pushed Filters:
24/06/03 17:29:03 INFO FileSourceStrategy: Post-Scan Filters:
24/06/03 17:29:03 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 353.5 KiB, free 365.1 MiB)
24/06/03 17:29:03 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.1 MiB)
24/06/03 17:29:03 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on master:42497 (size: 34.8 KiB, free: 366.2 MiB)
24/06/03 17:29:03 INFO SparkContext: Created broadcast 4 from javaToPython at NativeMethodAccessorImpl.java:0
24/06/03 17:29:03 INFO FileSourceScanExec: Planning scan with bin packing, max size: 134217728 bytes, open cost is considered as scanning 4194304 bytes.
24/06/03 17:29:03 INFO BlockManagerInfo: Removed broadcast_2_piece0 on 192.168.1.20:35785 in memory (size: 34.9 KiB, free: 366.3 MiB)
24/06/03 17:29:03 INFO BlockManagerInfo: Removed broadcast_2_piece0 on master:42497 in memory (size: 34.9 KiB, free: 366.2 MiB)
24/06/03 17:29:03 INFO BlockManagerInfo: Removed broadcast_2_piece0 on 192.168.1.236:41671 in memory (size: 34.9 KiB, free: 366.2 MiB)
24/06/03 17:29:03 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 192.168.1.236:41671 in memory (size: 6.4 KiB, free: 366.3 MiB)
24/06/03 17:29:03 INFO BlockManagerInfo: Removed broadcast_1_piece0 on master:42497 in memory (size: 6.4 KiB, free: 366.2 MiB)
24/06/03 17:29:03 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 192.168.1.20:35785 in memory (size: 13.0 KiB, free: 366.3 MiB)
24/06/03 17:29:03 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 192.168.1.236:41671 in memory (size: 13.0 KiB, free: 366.3 MiB)
24/06/03 17:29:03 INFO BlockManagerInfo: Removed broadcast_3_piece0 on master:42497 in memory (size: 13.0 KiB, free: 366.2 MiB)
24/06/03 17:29:03 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 192.168.1.236:41671 in memory (size: 34.9 KiB, free: 366.3 MiB)
24/06/03 17:29:03 INFO BlockManagerInfo: Removed broadcast_0_piece0 on master:42497 in memory (size: 34.9 KiB, free: 366.3 MiB)
24/06/03 17:29:03 INFO SparkContext: Starting job: sortBy at /home/osboxes/LSDM-code/questions.py:145
24/06/03 17:29:03 INFO DAGScheduler: Registering RDD 16 (groupByKey at /home/osboxes/LSDM-code/questions.py:147) as input to shuffle 0
24/06/03 17:29:03 INFO DAGScheduler: Got job 2 (sortBy at /home/osboxes/LSDM-code/questions.py:145) with 6 output partitions
24/06/03 17:29:03 INFO DAGScheduler: Final stage: ResultStage 3 (sortBy at /home/osboxes/LSDM-code/questions.py:145)
24/06/03 17:29:03 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 2)
24/06/03 17:29:03 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 2)
24/06/03 17:29:04 INFO DAGScheduler: Submitting ShuffleMapStage 2 (PairwiseRDD[16] at groupByKey at /home/osboxes/LSDM-code/questions.py:147), which has no missing parents
24/06/03 17:29:04 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 25.0 KiB, free 365.9 MiB)
24/06/03 17:29:04 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 13.1 KiB, free 365.9 MiB)
24/06/03 17:29:04 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on master:42497 (size: 13.1 KiB, free: 366.3 MiB)
24/06/03 17:29:04 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1585
24/06/03 17:29:04 INFO DAGScheduler: Submitting 6 missing tasks from ShuffleMapStage 2 (PairwiseRDD[16] at groupByKey at /home/osboxes/LSDM-code/questions.py:147) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5))
24/06/03 17:29:04 INFO TaskSchedulerImpl: Adding task set 2.0 with 6 tasks resource profile 0
24/06/03 17:29:04 INFO TaskSetManager: Starting task 0.0 in stage 2.0 (TID 7) (192.168.1.236, executor 0, partition 0, ANY, 8278 bytes)
24/06/03 17:29:04 INFO TaskSetManager: Starting task 1.0 in stage 2.0 (TID 8) (192.168.1.20, executor 1, partition 1, ANY, 8278 bytes)
24/06/03 17:29:04 INFO TaskSetManager: Starting task 2.0 in stage 2.0 (TID 9) (192.168.1.236, executor 0, partition 2, ANY, 8278 bytes)
24/06/03 17:29:04 INFO TaskSetManager: Starting task 3.0 in stage 2.0 (TID 10) (192.168.1.20, executor 1, partition 3, ANY, 8278 bytes)
24/06/03 17:29:04 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 192.168.1.236:41671 (size: 13.1 KiB, free: 366.3 MiB)
24/06/03 17:29:04 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 192.168.1.20:35785 (size: 13.1 KiB, free: 366.3 MiB)
24/06/03 17:29:05 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 192.168.1.236:41671 (size: 34.8 KiB, free: 366.3 MiB)
24/06/03 17:29:05 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 192.168.1.20:35785 (size: 34.8 KiB, free: 366.3 MiB)
24/06/03 17:29:20 INFO TaskSetManager: Starting task 4.0 in stage 2.0 (TID 11) (192.168.1.20, executor 1, partition 4, ANY, 8442 bytes)
24/06/03 17:29:20 INFO TaskSetManager: Finished task 3.0 in stage 2.0 (TID 10) in 15921 ms on 192.168.1.20 (executor 1) (1/6)
24/06/03 17:29:20 INFO TaskSetManager: Starting task 5.0 in stage 2.0 (TID 12) (192.168.1.20, executor 1, partition 5, ANY, 8606 bytes)
24/06/03 17:29:20 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 8) in 15950 ms on 192.168.1.20 (executor 1) (2/6)
24/06/03 17:29:20 INFO PythonAccumulatorV2: Connected to AccumulatorServer at host: 127.0.0.1 port: 42773
24/06/03 17:29:21 INFO TaskSetManager: Finished task 2.0 in stage 2.0 (TID 9) in 17207 ms on 192.168.1.236 (executor 0) (3/6)
24/06/03 17:29:21 INFO TaskSetManager: Finished task 0.0 in stage 2.0 (TID 7) in 17214 ms on 192.168.1.236 (executor 0) (4/6)
24/06/03 17:29:29 INFO TaskSetManager: Finished task 4.0 in stage 2.0 (TID 11) in 9656 ms on 192.168.1.20 (executor 1) (5/6)
24/06/03 17:29:30 INFO TaskSetManager: Finished task 5.0 in stage 2.0 (TID 12) in 10071 ms on 192.168.1.20 (executor 1) (6/6)
24/06/03 17:29:30 INFO TaskSchedulerImpl: Removed TaskSet 2.0, whose tasks have all completed, from pool
24/06/03 17:29:30 INFO DAGScheduler: ShuffleMapStage 2 (groupByKey at /home/osboxes/LSDM-code/questions.py:147) finished in 26.084 s
24/06/03 17:29:30 INFO DAGScheduler: looking for newly runnable stages
24/06/03 17:29:30 INFO DAGScheduler: running: Set()
24/06/03 17:29:30 INFO DAGScheduler: waiting: Set(ResultStage 3)
24/06/03 17:29:30 INFO DAGScheduler: failed: Set()
24/06/03 17:29:30 INFO DAGScheduler: Submitting ResultStage 3 (PythonRDD[19] at sortBy at /home/osboxes/LSDM-code/questions.py:145), which has no missing parents
24/06/03 17:29:30 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 13.1 KiB, free 365.9 MiB)
24/06/03 17:29:30 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 7.1 KiB, free 365.9 MiB)
24/06/03 17:29:30 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on master:42497 (size: 7.1 KiB, free: 366.2 MiB)
24/06/03 17:29:30 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1585
24/06/03 17:29:30 INFO DAGScheduler: Submitting 6 missing tasks from ResultStage 3 (PythonRDD[19] at sortBy at /home/osboxes/LSDM-code/questions.py:145) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5))
24/06/03 17:29:30 INFO TaskSchedulerImpl: Adding task set 3.0 with 6 tasks resource profile 0
24/06/03 17:29:30 INFO TaskSetManager: Starting task 1.0 in stage 3.0 (TID 13) (192.168.1.20, executor 1, partition 1, NODE_LOCAL, 7437 bytes)
24/06/03 17:29:30 INFO TaskSetManager: Starting task 2.0 in stage 3.0 (TID 14) (192.168.1.236, executor 0, partition 2, NODE_LOCAL, 7437 bytes)
24/06/03 17:29:30 INFO TaskSetManager: Starting task 3.0 in stage 3.0 (TID 15) (192.168.1.20, executor 1, partition 3, NODE_LOCAL, 7437 bytes)
24/06/03 17:29:30 INFO TaskSetManager: Starting task 4.0 in stage 3.0 (TID 16) (192.168.1.236, executor 0, partition 4, NODE_LOCAL, 7437 bytes)
24/06/03 17:29:30 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 192.168.1.20:35785 (size: 7.1 KiB, free: 366.2 MiB)
24/06/03 17:29:30 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 192.168.1.236:41671 (size: 7.1 KiB, free: 366.2 MiB)
24/06/03 17:29:30 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 0 to 192.168.1.20:58878
24/06/03 17:29:30 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 0 to 192.168.1.236:51902
24/06/03 17:29:31 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 17) (192.168.1.236, executor 0, partition 0, PROCESS_LOCAL, 7437 bytes)
24/06/03 17:29:31 INFO TaskSetManager: Finished task 4.0 in stage 3.0 (TID 16) in 1118 ms on 192.168.1.236 (executor 0) (1/6)
24/06/03 17:29:31 INFO TaskSetManager: Starting task 5.0 in stage 3.0 (TID 18) (192.168.1.20, executor 1, partition 5, PROCESS_LOCAL, 7437 bytes)
24/06/03 17:29:31 INFO TaskSetManager: Finished task 3.0 in stage 3.0 (TID 15) in 1157 ms on 192.168.1.20 (executor 1) (2/6)
24/06/03 17:29:31 INFO TaskSetManager: Finished task 2.0 in stage 3.0 (TID 14) in 1169 ms on 192.168.1.236 (executor 0) (3/6)
24/06/03 17:29:31 INFO TaskSetManager: Finished task 1.0 in stage 3.0 (TID 13) in 1274 ms on 192.168.1.20 (executor 1) (4/6)
24/06/03 17:29:31 INFO TaskSetManager: Finished task 5.0 in stage 3.0 (TID 18) in 453 ms on 192.168.1.20 (executor 1) (5/6)
24/06/03 17:29:31 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 17) in 542 ms on 192.168.1.236 (executor 0) (6/6)
24/06/03 17:29:31 INFO DAGScheduler: ResultStage 3 (sortBy at /home/osboxes/LSDM-code/questions.py:145) finished in 1.700 s
24/06/03 17:29:31 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
24/06/03 17:29:31 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool
24/06/03 17:29:31 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
24/06/03 17:29:31 INFO DAGScheduler: Job 2 finished: sortBy at /home/osboxes/LSDM-code/questions.py:145, took 27.963570 s
24/06/03 17:29:31 INFO SparkContext: Starting job: sortBy at /home/osboxes/LSDM-code/questions.py:145
24/06/03 17:29:31 INFO DAGScheduler: Got job 3 (sortBy at /home/osboxes/LSDM-code/questions.py:145) with 6 output partitions
24/06/03 17:29:31 INFO DAGScheduler: Final stage: ResultStage 5 (sortBy at /home/osboxes/LSDM-code/questions.py:145)
24/06/03 17:29:31 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 4)
24/06/03 17:29:31 INFO DAGScheduler: Missing parents: List()
24/06/03 17:29:31 INFO DAGScheduler: Submitting ResultStage 5 (PythonRDD[20] at sortBy at /home/osboxes/LSDM-code/questions.py:145), which has no missing parents
24/06/03 17:29:32 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 12.3 KiB, free 365.9 MiB)
24/06/03 17:29:32 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 6.8 KiB, free 365.8 MiB)
24/06/03 17:29:32 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on master:42497 (size: 6.8 KiB, free: 366.2 MiB)
24/06/03 17:29:32 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1585
24/06/03 17:29:32 INFO DAGScheduler: Submitting 6 missing tasks from ResultStage 5 (PythonRDD[20] at sortBy at /home/osboxes/LSDM-code/questions.py:145) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5))
24/06/03 17:29:32 INFO TaskSchedulerImpl: Adding task set 5.0 with 6 tasks resource profile 0
24/06/03 17:29:32 INFO TaskSetManager: Starting task 1.0 in stage 5.0 (TID 19) (192.168.1.20, executor 1, partition 1, NODE_LOCAL, 7437 bytes)
24/06/03 17:29:32 INFO TaskSetManager: Starting task 2.0 in stage 5.0 (TID 20) (192.168.1.236, executor 0, partition 2, NODE_LOCAL, 7437 bytes)
24/06/03 17:29:32 INFO TaskSetManager: Starting task 3.0 in stage 5.0 (TID 21) (192.168.1.20, executor 1, partition 3, NODE_LOCAL, 7437 bytes)
24/06/03 17:29:32 INFO TaskSetManager: Starting task 4.0 in stage 5.0 (TID 22) (192.168.1.236, executor 0, partition 4, NODE_LOCAL, 7437 bytes)
24/06/03 17:29:32 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 192.168.1.236:41671 (size: 6.8 KiB, free: 366.2 MiB)
24/06/03 17:29:32 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 192.168.1.20:35785 (size: 6.8 KiB, free: 366.2 MiB)
24/06/03 17:29:32 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 23) (192.168.1.20, executor 1, partition 0, PROCESS_LOCAL, 7437 bytes)
24/06/03 17:29:32 INFO TaskSetManager: Finished task 3.0 in stage 5.0 (TID 21) in 595 ms on 192.168.1.20 (executor 1) (1/6)
24/06/03 17:29:32 INFO TaskSetManager: Finished task 1.0 in stage 5.0 (TID 19) in 611 ms on 192.168.1.20 (executor 1) (2/6)
24/06/03 17:29:32 INFO TaskSetManager: Starting task 5.0 in stage 5.0 (TID 24) (192.168.1.20, executor 1, partition 5, PROCESS_LOCAL, 7437 bytes)
24/06/03 17:29:32 INFO TaskSetManager: Finished task 4.0 in stage 5.0 (TID 22) in 861 ms on 192.168.1.236 (executor 0) (3/6)
24/06/03 17:29:32 INFO TaskSetManager: Finished task 2.0 in stage 5.0 (TID 20) in 931 ms on 192.168.1.236 (executor 0) (4/6)
24/06/03 17:29:33 INFO TaskSetManager: Finished task 5.0 in stage 5.0 (TID 24) in 403 ms on 192.168.1.20 (executor 1) (5/6)
24/06/03 17:29:33 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 23) in 504 ms on 192.168.1.20 (executor 1) (6/6)
24/06/03 17:29:33 INFO DAGScheduler: ResultStage 5 (sortBy at /home/osboxes/LSDM-code/questions.py:145) finished in 1.149 s
24/06/03 17:29:33 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool
24/06/03 17:29:33 INFO DAGScheduler: Job 3 is finished. Cancelling potential speculative or zombie tasks for this job
24/06/03 17:29:33 INFO TaskSchedulerImpl: Killing all running tasks in stage 5: Stage finished
24/06/03 17:29:33 INFO DAGScheduler: Job 3 finished: sortBy at /home/osboxes/LSDM-code/questions.py:145, took 1.191752 s
24/06/03 17:29:33 INFO SparkContext: Starting job: collect at /home/osboxes/LSDM-code/questions.py:151
24/06/03 17:29:33 INFO DAGScheduler: Registering RDD 22 (sortBy at /home/osboxes/LSDM-code/questions.py:145) as input to shuffle 1
24/06/03 17:29:33 INFO DAGScheduler: Got job 4 (collect at /home/osboxes/LSDM-code/questions.py:151) with 6 output partitions
24/06/03 17:29:33 INFO DAGScheduler: Final stage: ResultStage 8 (collect at /home/osboxes/LSDM-code/questions.py:151)
24/06/03 17:29:33 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 7)
24/06/03 17:29:33 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 7)
24/06/03 17:29:33 INFO DAGScheduler: Submitting ShuffleMapStage 7 (PairwiseRDD[22] at sortBy at /home/osboxes/LSDM-code/questions.py:145), which has no missing parents
24/06/03 17:29:33 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 13.2 KiB, free 365.8 MiB)
24/06/03 17:29:33 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 7.7 KiB, free 365.8 MiB)
24/06/03 17:29:33 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on master:42497 (size: 7.7 KiB, free: 366.2 MiB)
24/06/03 17:29:33 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1585
24/06/03 17:29:33 INFO DAGScheduler: Submitting 6 missing tasks from ShuffleMapStage 7 (PairwiseRDD[22] at sortBy at /home/osboxes/LSDM-code/questions.py:145) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5))
24/06/03 17:29:33 INFO TaskSchedulerImpl: Adding task set 7.0 with 6 tasks resource profile 0
24/06/03 17:29:33 INFO TaskSetManager: Starting task 1.0 in stage 7.0 (TID 25) (192.168.1.20, executor 1, partition 1, NODE_LOCAL, 7426 bytes)
24/06/03 17:29:33 INFO TaskSetManager: Starting task 2.0 in stage 7.0 (TID 26) (192.168.1.236, executor 0, partition 2, NODE_LOCAL, 7426 bytes)
24/06/03 17:29:33 INFO TaskSetManager: Starting task 3.0 in stage 7.0 (TID 27) (192.168.1.20, executor 1, partition 3, NODE_LOCAL, 7426 bytes)
24/06/03 17:29:33 INFO TaskSetManager: Starting task 4.0 in stage 7.0 (TID 28) (192.168.1.236, executor 0, partition 4, NODE_LOCAL, 7426 bytes)
24/06/03 17:29:33 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 192.168.1.20:35785 (size: 7.7 KiB, free: 366.2 MiB)
24/06/03 17:29:33 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 192.168.1.236:41671 (size: 7.7 KiB, free: 366.2 MiB)
24/06/03 17:29:34 INFO TaskSetManager: Starting task 0.0 in stage 7.0 (TID 29) (192.168.1.20, executor 1, partition 0, PROCESS_LOCAL, 7426 bytes)
24/06/03 17:29:34 INFO TaskSetManager: Finished task 3.0 in stage 7.0 (TID 27) in 626 ms on 192.168.1.20 (executor 1) (1/6)
24/06/03 17:29:34 INFO TaskSetManager: Starting task 5.0 in stage 7.0 (TID 30) (192.168.1.20, executor 1, partition 5, PROCESS_LOCAL, 7426 bytes)
24/06/03 17:29:34 INFO TaskSetManager: Finished task 1.0 in stage 7.0 (TID 25) in 659 ms on 192.168.1.20 (executor 1) (2/6)
24/06/03 17:29:34 INFO TaskSetManager: Finished task 4.0 in stage 7.0 (TID 28) in 855 ms on 192.168.1.236 (executor 0) (3/6)
24/06/03 17:29:34 INFO TaskSetManager: Finished task 2.0 in stage 7.0 (TID 26) in 946 ms on 192.168.1.236 (executor 0) (4/6)
24/06/03 17:29:34 INFO TaskSetManager: Finished task 0.0 in stage 7.0 (TID 29) in 591 ms on 192.168.1.20 (executor 1) (5/6)
24/06/03 17:29:34 INFO TaskSetManager: Finished task 5.0 in stage 7.0 (TID 30) in 584 ms on 192.168.1.20 (executor 1) (6/6)
24/06/03 17:29:34 INFO TaskSchedulerImpl: Removed TaskSet 7.0, whose tasks have all completed, from pool
24/06/03 17:29:34 INFO DAGScheduler: ShuffleMapStage 7 (sortBy at /home/osboxes/LSDM-code/questions.py:145) finished in 1.280 s
24/06/03 17:29:34 INFO DAGScheduler: looking for newly runnable stages
24/06/03 17:29:34 INFO DAGScheduler: running: Set()
24/06/03 17:29:34 INFO DAGScheduler: waiting: Set(ResultStage 8)
24/06/03 17:29:34 INFO DAGScheduler: failed: Set()
24/06/03 17:29:34 INFO DAGScheduler: Submitting ResultStage 8 (PythonRDD[25] at collect at /home/osboxes/LSDM-code/questions.py:151), which has no missing parents
24/06/03 17:29:34 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 9.6 KiB, free 365.8 MiB)
24/06/03 17:29:34 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 5.7 KiB, free 365.8 MiB)
24/06/03 17:29:34 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on master:42497 (size: 5.7 KiB, free: 366.2 MiB)
24/06/03 17:29:34 INFO SparkContext: Created broadcast 9 from broadcast at DAGScheduler.scala:1585
24/06/03 17:29:34 INFO DAGScheduler: Submitting 6 missing tasks from ResultStage 8 (PythonRDD[25] at collect at /home/osboxes/LSDM-code/questions.py:151) (first 15 tasks are for partitions Vector(0, 1, 2, 3, 4, 5))
24/06/03 17:29:34 INFO TaskSchedulerImpl: Adding task set 8.0 with 6 tasks resource profile 0
24/06/03 17:29:34 INFO TaskSetManager: Starting task 1.0 in stage 8.0 (TID 31) (192.168.1.20, executor 1, partition 1, NODE_LOCAL, 7437 bytes)
24/06/03 17:29:34 INFO TaskSetManager: Starting task 4.0 in stage 8.0 (TID 32) (192.168.1.236, executor 0, partition 4, NODE_LOCAL, 7437 bytes)
24/06/03 17:29:34 INFO TaskSetManager: Starting task 3.0 in stage 8.0 (TID 33) (192.168.1.20, executor 1, partition 3, NODE_LOCAL, 7437 bytes)
24/06/03 17:29:34 INFO TaskSetManager: Starting task 5.0 in stage 8.0 (TID 34) (192.168.1.236, executor 0, partition 5, NODE_LOCAL, 7437 bytes)
24/06/03 17:29:34 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 192.168.1.20:35785 (size: 5.7 KiB, free: 366.2 MiB)
24/06/03 17:29:34 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 192.168.1.236:41671 (size: 5.7 KiB, free: 366.2 MiB)
24/06/03 17:29:34 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 1 to 192.168.1.20:58878
24/06/03 17:29:34 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 1 to 192.168.1.236:51902
24/06/03 17:29:35 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 35) (192.168.1.20, executor 1, partition 0, PROCESS_LOCAL, 7437 bytes)
24/06/03 17:29:35 INFO TaskSetManager: Finished task 3.0 in stage 8.0 (TID 33) in 639 ms on 192.168.1.20 (executor 1) (1/6)
24/06/03 17:29:35 INFO TaskSetManager: Starting task 2.0 in stage 8.0 (TID 36) (192.168.1.20, executor 1, partition 2, PROCESS_LOCAL, 7437 bytes)
24/06/03 17:29:35 INFO TaskSetManager: Finished task 1.0 in stage 8.0 (TID 31) in 709 ms on 192.168.1.20 (executor 1) (2/6)
24/06/03 17:29:35 INFO TaskSetManager: Finished task 5.0 in stage 8.0 (TID 34) in 728 ms on 192.168.1.236 (executor 0) (3/6)
24/06/03 17:29:35 INFO TaskSetManager: Finished task 4.0 in stage 8.0 (TID 32) in 814 ms on 192.168.1.236 (executor 0) (4/6)
24/06/03 17:29:35 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 35) in 498 ms on 192.168.1.20 (executor 1) (5/6)
24/06/03 17:29:35 INFO TaskSetManager: Finished task 2.0 in stage 8.0 (TID 36) in 474 ms on 192.168.1.20 (executor 1) (6/6)
24/06/03 17:29:35 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool
24/06/03 17:29:35 INFO DAGScheduler: ResultStage 8 (collect at /home/osboxes/LSDM-code/questions.py:151) finished in 1.198 s
24/06/03 17:29:35 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
24/06/03 17:29:35 INFO TaskSchedulerImpl: Killing all running tasks in stage 8: Stage finished
24/06/03 17:29:35 INFO DAGScheduler: Job 4 finished: collect at /home/osboxes/LSDM-code/questions.py:151, took 2.559354 s
('midnight (21:00-04:59)', 243374)
('night (17:00-20:59)', 191792)
('afternoon (12:00-16:59)', 151564)
('morning (05:00-11:59)', 126611)
24/06/03 17:29:35 INFO SparkContext: SparkContext is stopping with exitCode 0.
24/06/03 17:29:35 INFO SparkUI: Stopped Spark web UI at http://master:4040
24/06/03 17:29:35 INFO StandaloneSchedulerBackend: Shutting down all executors
24/06/03 17:29:35 INFO StandaloneSchedulerBackend$StandaloneDriverEndpoint: Asking each executor to shut down
24/06/03 17:29:36 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
24/06/03 17:29:36 INFO MemoryStore: MemoryStore cleared
24/06/03 17:29:36 INFO BlockManager: BlockManager stopped
24/06/03 17:29:36 INFO BlockManagerMaster: BlockManagerMaster stopped
24/06/03 17:29:36 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
24/06/03 17:29:36 INFO SparkContext: Successfully stopped SparkContext
Total time elapsed: 74.997 seconds.
24/06/03 17:29:36 INFO ShutdownHookManager: Shutdown hook called
24/06/03 17:29:36 INFO ShutdownHookManager: Deleting directory /tmp/spark-be11b1fd-e83c-450c-afc1-bdae9cf5ba5c/pyspark-c3e5d756-8237-4a87-95b9-0db7ca7b089d
24/06/03 17:29:36 INFO ShutdownHookManager: Deleting directory /tmp/spark-be11b1fd-e83c-450c-afc1-bdae9cf5ba5c
24/06/03 17:29:36 INFO ShutdownHookManager: Deleting directory /tmp/spark-49681ed6-62aa-4ff5-97a2-9dc4a9946707